## Данная программа автоматизирует расчёт тарифов путем взаимодействия с интерфейсом программы RT.

Логика работы следующая: в отдельном файле Excel поступают заранее размеченные данные о корреспонденциях.

Эти данные подгружаются в датафрейм (pandas) и на основе данных каждой строки происходит параметризация запроса к RT.

Для исключения ошибок в поступивших данных происходит их валидация через проверку на то, что коды существуют.

Каждая корреспонденция дополняется информацией о географическом расположении станций и принадлежности к региону.

Взаимодействие с RT осуществляется посредством имитации ручного ввода в интерфейс программы RT.

Имитация ручного ввода организована через управление клавиатурой и поиском отдельных элементов на экране (OpenCV).

Результат полученных данных из RT записывается в датафрейм и в отдельные выгрузки Excel.

Итоговый датафрейм выгружается в исходный файл Excel, дополняя его данными из RT.

Также данные собираются в БД на sqlite3 для кэширования.


## Логика программы.

Создан объект с полями, соответствующими всем параметрам корреспонденции.

Созданы отдельные модули, различающиеся по взаимодействию с RT.

Запуск цикла по длине датафрейма, в котором на каждой итерации осуществляется по-очередный вызов модулей.

Ключевая сложность заключается в том, что по основным операциям, связанным с взаимодействием с окном программы RT, почти нигде невозможно на уровне программы (кода) получить подтверждение об успешности выполненного действия.

В связи с этим, фактически, программа работает на ожидании успешности выполняемых операций с заложенными подстраховками.


## Следующий шаг развития программы (TODOs).

Добавление асинхронного выполнения (РЕАЛИЗОВАНО):

- при выгрузке данных из сервера про географические параметры станций (так как от их наличия не зависит получение данных о тарифе);
  
- при записи результатов в базу данных (позволит при использовании удалённой БД не ждать сетевых соединений);

Переход на другую схему взаимодействия с БД:

- перевод на SQL Alchemy (потому что писать такие запросы к БД, как сейчас - это ужасно) - РЕАЛИЗОВАНО;

- перевод на PostgreSQL (чтобы немного добавить "взрослых" реализаций).

Создание простого веб-сервиса с использованием FastAPI (просто для тестирования и самообразования) - РЕАЛИЗОВАНО.

Попытаться отказаться от RT и воспользоваться автоматизированными системами расчёта тарифов (кардинальная переработка, повышение быстродействия, но, при этом, снижение надёжности, так как упускается часть контроля над происходящим - в частности визуального контроля).